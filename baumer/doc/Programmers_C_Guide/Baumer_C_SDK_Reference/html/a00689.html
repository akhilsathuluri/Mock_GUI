<!DOCTYPE html>
<html>
<head>
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta charset="utf-8" />
    <!-- For Mobile Devices -->
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8" />
    <meta name="generator" content="Doxygen 1.8.15" />
    <script type="text/javascript" src="https://code.jquery.com/jquery-2.1.1.min.js"></script>
    <title>Baumer GAPI SDK for C Documentation: Basic Programming Concepts of the Baumer GAPI SDK for C</title>
    <link rel="shortcut icon" type="image/x-icon" media="all" href="favicon.ico" />
    <link href='https://fonts.googleapis.com/css?family=Roboto+Slab' rel='stylesheet' type='text/css' />
    <link href="https://fonts.googleapis.com/css?family=Roboto+Condensed:300,400" rel="stylesheet" media="all" type='text/css' />
    <script type="text/javascript" src="dynsections.js"></script>
    <link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<link rel="search" href="search_opensearch.php?v=opensearch.xml" type="application/opensearchdescription+xml" title="Baumer GAPI SDK for C Documentation"/>
    <link href="doxygen.css" rel="stylesheet" type="text/css" />
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/css/bootstrap.min.css" />
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/js/bootstrap.min.js"></script>
    <link href="jquery.smartmenus.bootstrap.css" rel="stylesheet" />
    <script type="text/javascript" src="jquery.smartmenus.js"></script>
    <!-- SmartMenus jQuery Bootstrap Addon -->
    <script type="text/javascript" src="jquery.smartmenus.bootstrap.js"></script>
    <!-- SmartMenus jQuery plugin -->
    <link href="customdoxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
    <nav class="navbar navbar-default" role="navigation">
        <div class="container">
            <div class="navbar-header">
                <img id="logo" src="BaumerLogo.png" /><span>Baumer GAPI SDK for C Documentation</span>
            </div>
        </div>
    </nav>
    <div id="top">
        <!-- do not remove this div, it is closed by doxygen! -->
        <div class="content" id="content">
            <div class="container">
                <div class="row">
                    <div class="col-sm-12 panel " style="padding-bottom: 15px;">
                        <div style="margin-bottom: 15px;">
                            <!-- end header part -->
<!-- Generated by Doxygen 1.8.15 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,true,'search.html','Search');
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
  $(document).ready(function() {
    if ($('.searchresults').length > 0) { searchBox.DOMSearchField().focus(); }
  });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">Basic Programming Concepts of the Baumer GAPI SDK for C </div>  </div>
</div><!--header-->
<div class="contents">
<div class="toc"><h3>Table of Contents</h3>
<ul><li class="level1"><a href="#autotoc_md17">Physically connect the camera to the system</a><ul><li class="level2"><a href="#autotoc_md18">U3V(USB) cameras</a></li>
<li class="level2"><a href="#autotoc_md19">GigE(Ethernet) cameras</a></li>
</ul>
</li>
<li class="level1"><a href="#autotoc_md20">Connect a camera device using the Baumer GAPI SDK for C</a><ul><li class="level2"><a href="#autotoc_md21">Setup of the project, required headers</a></li>
<li class="level2"><a href="#autotoc_md22">The Baumer GAPI model of the camera system</a><ul><li class="level3"><a href="#autotoc_md23">The System</a></li>
<li class="level3"><a href="#autotoc_md24">The Interface</a></li>
<li class="level3"><a href="#autotoc_md25">The Device</a></li>
<li class="level3"><a href="#autotoc_md26">The DataStream</a></li>
<li class="level3"><a href="#autotoc_md27">The Buffer</a></li>
</ul>
</li>
<li class="level2"><a href="#autotoc_md28">Lifetime of objects</a></li>
<li class="level2"><a href="#autotoc_md29">Error handling</a></li>
<li class="level2"><a href="#autotoc_md30">Example: Connect a camera</a></li>
</ul>
</li>
<li class="level1"><a href="#autotoc_md31">Working with camera features</a><ul><li class="level2"><a href="#autotoc_md32">Feature types</a></li>
<li class="level2"><a href="#autotoc_md33">Is the feature implemented and available?</a></li>
<li class="level2"><a href="#autotoc_md34">Is the feature available for reading or writing?</a></li>
<li class="level2"><a href="#autotoc_md35">Read and write feature values</a></li>
<li class="level2"><a href="#autotoc_md36">Handling features with a set increment</a></li>
<li class="level2"><a href="#autotoc_md37">When do changed feature settings become active?</a></li>
<li class="level2"><a href="#autotoc_md38">Execute ICommand features</a></li>
<li class="level2"><a href="#autotoc_md39">Using IEnumeration features</a></li>
<li class="level2"><a href="#autotoc_md40">Further feature attributes</a></li>
</ul>
</li>
<li class="level1"><a href="#autotoc_md41">Images and buffers</a><ul><li class="level2"><a href="#autotoc_md42">How are images transferred to the application?</a></li>
</ul>
</li>
</ul>
</div>
<div class="textblock"><p>This document is meant to describe the basics on how to operate a camera using the Baumer GAPI SDK for C.</p>
<h1><a class="anchor" id="autotoc_md17"></a>
Physically connect the camera to the system</h1>
<p>Obviously, the first step to work with a camera is to physically connect it to the data interface and a power source.</p>
<h2><a class="anchor" id="autotoc_md18"></a>
U3V(USB) cameras</h2>
<p>All Baumer U3V cameras need to be connected to a free USB3 port on your host system. The USB3 port delivers the necessary power for the camera and provides the data interface. For Windows to recognize the camera it is necessary to install the Baumer USB driver provided in the Baumer GAPI installer. On Linux systems the libusb package is used and no further driver is necessary, however the udev-rules need to be configured to raise the available memory for the USB-system.</p>
<p>When connecting several cameras to one host, it is necessary to think about the USB architecture of your host system. Typically, a host system has several USB3 controllers. Each controller provides the specified bandwidth for USB3, however if more than one device is connected to one controller they have to share the available bandwidth. So if you need the full USB3 bandwidth, you need to ensure each camera is connected to its own USB3 controller.</p>
<p>Troubleshooting tips:</p>
<ul>
<li>Use high-quality USB3 cables as a low quality cable can influence the maximum transfer rate of the camera. Low quality cable might also not be able to deliver the necessary power for the camera.</li>
<li>Ensure, that the chosen USB-port does actually deliver the required power of your camera (see the data-sheet of your camera for details on power consumption).</li>
<li>When using a USB-hub, ensure that it is specified for the required data speed and power consumption of your camera.</li>
</ul>
<h2><a class="anchor" id="autotoc_md19"></a>
GigE(Ethernet) cameras</h2>
<p>Baumer GigE cameras are connected through standard ethernet ports. Standard GigE cameras require a free Gigabit Ethernet port to achieve their full framerate. 10GigE cameras like the LXT-series will need a free 10 Gigabit Ethernet port. On Windows systems, the Baumer filter-driver provided with the Baumer GAPI installer can be installed to reduce the processor load caused by the data-transfer.</p>
<p>When connecting multiple cameras to a host system, it is important to think about the ethernet network topology. When working with switches, it needs to be ensured that the uplink can support the bandwidth requirements of multiple cameras.</p>
<p>Depending on your application, the cameras can be powered via PoE or via an external power supply. Please see the data-sheet of your camera for details.</p>
<p>Troubleshooting tips:</p>
<ul>
<li>Use high-quality Ethernet cables as a low quality cable can influence the maximum transfer rate of the camera. Low quality cable might also not be able to deliver the necessary power for the camera.</li>
<li>Ensure, that the chosen power supply does actually deliver the required power of your camera (see the data-sheet of your camera for details on power consumption).</li>
<li>When using a switch, ensure that it is specified for the required data speed.</li>
</ul>
<h1><a class="anchor" id="autotoc_md20"></a>
Connect a camera device using the Baumer GAPI SDK for C</h1>
<p>The Baumer GAPI SDK for C provides you with a unified interface to all system components of a camera system. It is based on the GenTL and the GenICam API's provided and maintained by the EMVA.</p>
<h2><a class="anchor" id="autotoc_md21"></a>
Setup of the project, required headers</h2>
<p>For the setup of an example project, please see the <a class="el" href="a00688.html">Setup and Getting Started</a> page.</p>
<h2><a class="anchor" id="autotoc_md22"></a>
The Baumer GAPI model of the camera system</h2>
<p>The API has 6 main sets of functions to deal with the different components of the camera system: System, Interface, Device, DataStream, Buffer and Node.</p>
<h3><a class="anchor" id="autotoc_md23"></a>
The System</h3>
<p>The System module provides access to a GenTL Producer and encapsulates a method of transport such as USB or Ethernet. Use the <code><a class="el" href="a00027.html#gadb540c498f132015a86c9db1d4f89774" title="Search for GenTL producers in the current directory and in GENICAM_GENTLxx_PATH.">BGAPI2_UpdateSystemList()</a></code> function to search for available producers and <code><a class="el" href="a00027.html#gae5a189a21587f7648ec0d3fd111a39b5" title="Get a pointer to the System (GenTL Producer) specified by the index.">BGAPI2_GetSystem()</a></code> to access a system specified by the index. Finally call <code><a class="el" href="a00027.html#gaf2becead80c903ef2c4a6e9291d76b28" title="Opens a system (GenTL producer) to work with it.">BGAPI2_System_Open()</a></code> to open a system to work with it.</p>
<p>See the section <a class="el" href="a00027.html">System functions</a> for details on each available function.</p>
<h3><a class="anchor" id="autotoc_md24"></a>
The Interface</h3>
<p>Each (useful) System has one or more Interfaces. An Interface is a specific Ethernet or USB port where a GenICam camera is connected to. Use the <code><a class="el" href="a00027.html#ga10c317f1a55f4cccba863ab4868dbf93" title="Updates the list of of accessable interfaces and creates an object for each.">BGAPI2_System_UpdateInterfaceList()</a></code> function to update the list of available interfaces for your system followed by a call to <code><a class="el" href="a00027.html#ga4cc282fc2d7b4831bb095cdf45b482a3" title="Get a pointer to the interface with the specified index.">BGAPI2_System_GetInterface()</a></code> and <code><a class="el" href="a00028.html#gabcee3b314a7f5a4e86518c3bd4c20d38" title="Opens an interface.">BGAPI2_Interface_Open()</a></code> to open the interface specified by the index to work with it.</p>
<p>See the <a class="el" href="a00028.html">Interface functions</a> for details on each available function.</p>
<h3><a class="anchor" id="autotoc_md25"></a>
The Device</h3>
<p>Each Interface can have one or more Devices (typically a camera) connected to it. You can use the <code><a class="el" href="a00028.html#gac2d83c4747ed0fc1ec9b276ffa080435" title="Updates the list of devices on the interface and creates an object for each found device.">BGAPI2_Interface_UpdateDeviceList()</a></code> function to update the list of available Devices followed by a <code><a class="el" href="a00028.html#gaa1620329ecb9167422211adcac3b0a4e" title="Get a pointer to the device with supplied index.">BGAPI2_Interface_GetDevice()</a></code> and <code><a class="el" href="a00029.html#ga7798220c41099b19c75004ecec9e1378" title="Opens a device for reading and writing.">BGAPI2_Device_Open()</a></code> to open a chosen Device to work with it.</p>
<p>See the <a class="el" href="a00029.html">Device functions</a> for details on each available function.</p>
<h3><a class="anchor" id="autotoc_md26"></a>
The DataStream</h3>
<p>Each Device (camera) can have one or more DataStreams where images can be retrieved. You can use the <code><a class="el" href="a00029.html#ga6f8f9a70517de7e7e30120260932263d" title="Returns a pointer to the data stream handle identified by index.">BGAPI2_Device_GetDataStream()</a></code> function to get a DataStream by index, followed by a <code><a class="el" href="a00030.html#ga32a99e1e6d74150462c62e0aed721cf0" title="Opens a datastream.">BGAPI2_DataStream_Open()</a></code> to open the DataStream to work with it.</p>
<p>See the <a class="el" href="a00030.html">DataStream functions</a> for details on each available function.</p>
<h3><a class="anchor" id="autotoc_md27"></a>
The Buffer</h3>
<p>Buffers are required to queue retrieve images from the DataStream. Firstly create some Buffers using the <code><a class="el" href="a00031.html#ga974a364adb0335d9000e2e3d8dd0c3a6" title="Creates a new buffer.">BGAPI2_CreateBuffer()</a></code> function. Next you need to announce and queue Buffers to the DataStream using <code><a class="el" href="a00030.html#ga52ef0114ee88d904a8d030db629da94a" title="Adds the Buffer objects to the datastream.">BGAPI2_DataStream_AnnounceBuffer()</a></code> and <code><a class="el" href="a00030.html#ga613165fd182f04c8bb0c7a9f55b908af" title="Moves a Buffer object into the input buffer queue and make it available for the image acquisition.">BGAPI2_DataStream_QueueBuffer()</a></code>. To retrieve an image the <code><a class="el" href="a00030.html#ga76bcbef15426477683bed38ca84376a6" title="Fetches a new image from the DataStream object and removes it from the output buffer queue.">BGAPI2_DataStream_GetFilledBuffer()</a></code> is used.</p>
<p>See the <a class="el" href="a00031.html">Buffer functions</a> for details on each available function.</p>
<h2><a class="anchor" id="autotoc_md28"></a>
Lifetime of objects</h2>
<p>When using the Baumer GAPI SDK for C you have full responsibility for the memory management of your application. You need to ensure that objects which are created are closed once not required anymore.</p>
<p>The Baumer GAPI "objects" are structured hierarchically and each object has an update-list function. Those update functions create the child-objects of a certain type. To close/destroy those objects it is sufficient to call <code><a class="el" href="a00027.html#gac2defaef708c264e9a2418681a5e5d85" title="Closes a system (producer), you need to call BGAPI2_ReleaseSystem to unload the library.">BGAPI2_System_Close()</a></code> and <code><a class="el" href="a00027.html#gacf48c12e61a8350618fcb15f575b2f6e" title="Release a system (GenTL producer) specified. You need to call BGAPI2_System_Close first!">BGAPI2_ReleaseSystem()</a></code> on the parent System. If you choose to manually close the object you need to ensure, that you destroy them in the right order.</p>
<p>Objects created as children of objects through functions:</p>
<ul>
<li><code><a class="el" href="a00027.html#gadb540c498f132015a86c9db1d4f89774" title="Search for GenTL producers in the current directory and in GENICAM_GENTLxx_PATH.">BGAPI2_UpdateSystemList()</a></code> - creates zero or more System objects</li>
<li><code><a class="el" href="a00027.html#ga10c317f1a55f4cccba863ab4868dbf93" title="Updates the list of of accessable interfaces and creates an object for each.">BGAPI2_System_UpdateInterfaceList()</a></code> - creates zero or more Interface objects</li>
<li><code><a class="el" href="a00028.html#gac2d83c4747ed0fc1ec9b276ffa080435" title="Updates the list of devices on the interface and creates an object for each found device.">BGAPI2_Interface_UpdateDeviceList()</a></code>- creates zero or more Device objects</li>
</ul>
<p>Some objects are created independent and you are attaching them to parent object such as providing Buffers to the DataStream. To close/destroy those objects you need to de-attach them and destroy them manually.</p>
<p>Objects which exists independently from parent objects:</p>
<ul>
<li><code><a class="el" href="a00031.html#ga974a364adb0335d9000e2e3d8dd0c3a6" title="Creates a new buffer.">BGAPI2_CreateBuffer()</a></code> - creates a Buffer object</li>
<li><code><a class="el" href="a00029.html#ga51eb55ca8ba6a4d4f615acc6e7203de5" title="Creates a structure to store device events retrieved via BGAPI2_Device_GetDeviceEvent">BGAPI2_CreateDeviceEvent()</a></code> - creates an DeviceEvent object</li>
<li><code><a class="el" href="a00028.html#gad74afd5144ebb4916c387a212c6a2f7b" title="Creates a structure to store pnp events retrieved via BGAPI2_Interface_GetPnPEvent">BGAPI2_CreatePnPEvent()</a></code> - creates an PnPEvent object</li>
</ul>
<h2><a class="anchor" id="autotoc_md29"></a>
Error handling</h2>
<p>As typical for C, the Baumer GAPI SDK for C makes use of return codes to communicate success, failure and errors. The result codes are provided as constants starting with <code>BGAPI2_RESULT_*</code></p>
<h2><a class="anchor" id="autotoc_md30"></a>
Example: Connect a camera</h2>
<p>The following example shows how to connect a camera set the exposure time and retrieve one image into a buffer. We print the frame ID, which is a counter the camera will increment and send with each image as a way to check if the image was actually retrieved correctly from the camera.</p>
<blockquote class="doxtable">
<p><b>Attention</b></p>
<p>For clarity, and to focus on actual functionality the examples provided make assumptions on the system without handling errors. This code is not suitable for production without error-handling! The SDK provides examples, those contain the full error-handling so that they can run on any system without crashes. </p>
</blockquote>
<div class="fragment"><div class="line"><span class="preprocessor">#include &lt;stdlib.h&gt;</span></div><div class="line"><span class="preprocessor">#include &lt;stdio.h&gt;</span></div><div class="line"><span class="preprocessor">#include &lt;string.h&gt;</span></div><div class="line"><span class="preprocessor">#include &quot;<a class="code" href="a00002.html">bgapi2_genicam/bgapi2_genicam.h</a>&quot;</span></div><div class="line"></div><div class="line"><span class="keywordtype">int</span> main() {</div><div class="line">    <span class="comment">// Create the system</span></div><div class="line">    <a class="code" href="a00027.html#gadb540c498f132015a86c9db1d4f89774">BGAPI2_UpdateSystemList</a>();                                   <span class="comment">// Update the list of producers (systems)</span></div><div class="line">    <a class="code" href="a00027.html#ga39205661b5cdfa30f750db53c3c768ca">BGAPI2_System</a>* system = NULL;                                <span class="comment">// Create the pointer for the system</span></div><div class="line"></div><div class="line">    <span class="comment">// We expect that GetSystem &quot;1&quot; will be the USB Producer, that should be the case if just the Baumer Producers</span></div><div class="line">    <span class="comment">// and no additional producers are found on the system</span></div><div class="line">    <a class="code" href="a00027.html#gae5a189a21587f7648ec0d3fd111a39b5">BGAPI2_GetSystem</a>(1, &amp;system);                                <span class="comment">// We want to use the producer with index 1 (second)</span></div><div class="line">    <a class="code" href="a00027.html#gaf2becead80c903ef2c4a6e9291d76b28">BGAPI2_System_Open</a>(system);                                  <span class="comment">// Open the system to use it</span></div><div class="line"></div><div class="line">    <span class="comment">// Create the interface</span></div><div class="line">    bo_bool changed = 0;                                         <span class="comment">// Flag for the changed status (not used in this example)</span></div><div class="line">    <a class="code" href="a00027.html#ga10c317f1a55f4cccba863ab4868dbf93">BGAPI2_System_UpdateInterfaceList</a>(system, &amp;changed, 200);    <span class="comment">// Update list of interfaces with timout of 200 ms</span></div><div class="line">    <a class="code" href="a00028.html#gab3374f74c970cb3e408c913886651a62">BGAPI2_Interface</a>* iface = NULL;                              <span class="comment">// Create the pointer for the interface</span></div><div class="line">    <a class="code" href="a00027.html#ga4cc282fc2d7b4831bb095cdf45b482a3">BGAPI2_System_GetInterface</a>(system, 0, &amp;iface);               <span class="comment">// We want to use the first interface (USB has just one)</span></div><div class="line">    <a class="code" href="a00028.html#gabcee3b314a7f5a4e86518c3bd4c20d38">BGAPI2_Interface_Open</a>(iface);                                <span class="comment">// Open the interface to use it</span></div><div class="line"></div><div class="line">    <span class="comment">// Create the device</span></div><div class="line">    <a class="code" href="a00028.html#gac2d83c4747ed0fc1ec9b276ffa080435">BGAPI2_Interface_UpdateDeviceList</a>(iface, &amp;changed, 200);     <span class="comment">// Update list of devices with timout of 200 ms</span></div><div class="line">    <a class="code" href="a00029.html#gabd7810e88d6bfdca9e33ef1b3f7a5db0">BGAPI2_Device</a>* device = NULL;                                <span class="comment">// Create the pointer for the camera</span></div><div class="line">    <a class="code" href="a00028.html#gaa1620329ecb9167422211adcac3b0a4e">BGAPI2_Interface_GetDevice</a>(iface, 0, &amp;device);               <span class="comment">// We want to use the first camera</span></div><div class="line">    <a class="code" href="a00029.html#ga7798220c41099b19c75004ecec9e1378">BGAPI2_Device_Open</a>(device);                                  <span class="comment">// Open the camera to use it</span></div><div class="line"></div><div class="line">    <span class="comment">// Set the ExposureTime feature</span></div><div class="line">    <a class="code" href="a00032.html#ga1d12f852b4519b48fa4a43631b15a5cf">BGAPI2_Node</a>* node = NULL;                                    <span class="comment">// Create the pointer for the node</span></div><div class="line">    <a class="code" href="a00029.html#gafc0bdfc74d18c787b0abec69d20a0485">BGAPI2_Device_GetRemoteNode</a>(device, <a class="code" href="a00041.html#gafdce2f7b301559131c7ccdabbe2ddcb6">SFNC_EXPOSURETIME</a>, &amp;node);  <span class="comment">// Get the node ExposureTime</span></div><div class="line">    bo_double exposuretime = 0;</div><div class="line">    <a class="code" href="a00032.html#ga5ecc3defc8fc84020618ff75c759d7a5">BGAPI2_Node_GetDouble</a>(node, &amp;exposuretime);                  <span class="comment">// Get the ExposureTime from the camera</span></div><div class="line">    printf(<span class="stringliteral">&quot;The exposure time is set to: %lld micro seconds\n&quot;</span>, (<span class="keywordtype">long</span> <span class="keywordtype">long</span>)exposuretime);</div><div class="line">    <a class="code" href="a00032.html#ga846c51e6a4e108760c029e56abb9b834">BGAPI2_Node_SetDouble</a>(node, 10000.0);                        <span class="comment">// Set the ExposureTime to 10000 µs</span></div><div class="line"></div><div class="line">    <span class="comment">// Open the data stream</span></div><div class="line">    <a class="code" href="a00030.html#ga344e24fd042e6dabd28d2b11eab6e9fe">BGAPI2_DataStream</a>* datastream = NULL;                        <span class="comment">// Create the pointer for the data stream</span></div><div class="line">    <a class="code" href="a00029.html#ga6f8f9a70517de7e7e30120260932263d">BGAPI2_Device_GetDataStream</a>(device, 0, &amp;datastream);         <span class="comment">// We want to use the first data stream</span></div><div class="line">    <a class="code" href="a00030.html#ga32a99e1e6d74150462c62e0aed721cf0">BGAPI2_DataStream_Open</a>(datastream);                          <span class="comment">// Open the data stream to use it</span></div><div class="line"></div><div class="line">    <span class="comment">// Retrieve an image into an buffer</span></div><div class="line">    <a class="code" href="a00031.html#ga41b4fef7453483371e949a15d4da0b81">BGAPI2_Buffer</a>* buffer;                                       <span class="comment">// Create the pointer for the image buffer</span></div><div class="line">    <a class="code" href="a00031.html#ga974a364adb0335d9000e2e3d8dd0c3a6">BGAPI2_CreateBuffer</a>(&amp;buffer);                                <span class="comment">// Create a buffer</span></div><div class="line">    <a class="code" href="a00030.html#ga52ef0114ee88d904a8d030db629da94a">BGAPI2_DataStream_AnnounceBuffer</a>(datastream, buffer);        <span class="comment">// Announce the buffer to the datastream</span></div><div class="line">    <a class="code" href="a00030.html#ga613165fd182f04c8bb0c7a9f55b908af">BGAPI2_DataStream_QueueBuffer</a>(datastream, buffer);           <span class="comment">// Queue the buffer to be used</span></div><div class="line"></div><div class="line">    <a class="code" href="a00030.html#gab7550ba5991e96dccddcdbdca967e83c">BGAPI2_DataStream_StartAcquisition</a>(datastream, 1);           <span class="comment">// Acquire one image from the camera</span></div><div class="line">    <a class="code" href="a00029.html#gafc0bdfc74d18c787b0abec69d20a0485">BGAPI2_Device_GetRemoteNode</a>(device, SFNC_ACQUISITIONSTART, &amp;node);  <span class="comment">// Get the node &quot;AcquisitionStart&quot;</span></div><div class="line">    <a class="code" href="a00032.html#ga4a8ff179abaaf701ca6208b85da234d5">BGAPI2_Node_Execute</a>(node);                                   <span class="comment">// Execute the &quot;AcquisitionStart&quot; feature</span></div><div class="line"></div><div class="line">    <a class="code" href="a00031.html#ga41b4fef7453483371e949a15d4da0b81">BGAPI2_Buffer</a>* bufferfilled = NULL;                          <span class="comment">// Create the pointer for a buffer to reference result image</span></div><div class="line">    <a class="code" href="a00030.html#ga76bcbef15426477683bed38ca84376a6">BGAPI2_DataStream_GetFilledBuffer</a>(datastream, &amp;bufferfilled, 1000);  <span class="comment">// Get the image from the camera into the buffer provided</span></div><div class="line"></div><div class="line">    bo_uint64 bufferID = 9999;                                   <span class="comment">// Set the buffer ID to something arbitary</span></div><div class="line">    <a class="code" href="a00031.html#gaa47d9986c6175ddea20f337e4208ca08">BGAPI2_Buffer_GetFrameID</a>(bufferfilled, &amp;bufferID);           <span class="comment">// Get the buffer ID from the buffer to check if we got an image</span></div><div class="line">    printf(<span class="stringliteral">&quot;Frame ID: %lld\n&quot;</span>, (<span class="keywordtype">long</span> <span class="keywordtype">long</span>)bufferID);             <span class="comment">// Print buffer ID (0 or 1 depending on the camera)</span></div><div class="line"></div><div class="line">    <span class="comment">// Start the cleanup process</span></div><div class="line">    <a class="code" href="a00030.html#gab90a855d432dbbc64421a6e70c25e718">BGAPI2_DataStream_StopAcquisition</a>(datastream);               <span class="comment">// Stop the acquisition</span></div><div class="line">    <a class="code" href="a00030.html#gad7cc9502ec67f4f556f767025e8bfb06">BGAPI2_DataStream_DiscardAllBuffers</a>(datastream);             <span class="comment">// We don&#39;t need the buffer data anymore</span></div><div class="line">    <a class="code" href="a00030.html#gaf68fd9bef59b1de6b71e7551e262ddad">BGAPI2_DataStream_RevokeBuffer</a>(datastream, buffer, NULL);    <span class="comment">// Remove buffer from the queue</span></div><div class="line">    <a class="code" href="a00031.html#ga7edddac8b9beef5935b0d1080a4a89e2">BGAPI2_DeleteBuffer</a>(buffer, NULL);                           <span class="comment">// Delete the buffer</span></div><div class="line">    <a class="code" href="a00030.html#gac5c155576112d81d765311a9cc25b8c5">BGAPI2_DataStream_Close</a>(datastream);                         <span class="comment">// Close the data stream</span></div><div class="line">    <a class="code" href="a00029.html#gad2e27a47950f50b5bd5a4f54176d79f3">BGAPI2_Device_Close</a>(device);                                 <span class="comment">// Close the device</span></div><div class="line">    <a class="code" href="a00028.html#ga60d940198c7212c6a94185052c07cdc6">BGAPI2_Interface_Close</a>(iface);                               <span class="comment">// Close the interface</span></div><div class="line">    <a class="code" href="a00027.html#gac2defaef708c264e9a2418681a5e5d85">BGAPI2_System_Close</a>(system);                                 <span class="comment">// Close the system</span></div><div class="line">    <a class="code" href="a00027.html#gacf48c12e61a8350618fcb15f575b2f6e">BGAPI2_ReleaseSystem</a>(system);                                <span class="comment">// Release the producer library</span></div><div class="line">}</div></div><!-- fragment --> <div class="caption">Example: Connect a camera to retrieve an image</div><h1><a class="anchor" id="autotoc_md31"></a>
Working with camera features</h1>
<p>Every camera project requires configuring at least some basic settings of the camera. GenICam compatible devices use the SFNC naming convention to standardize how features are named <a class="el" href="a00687.html">see here</a> for details about the machine vision standards.</p>
<p>Using the Baumer GAPI SDK each feature is presented as a node. A node has functions to get and set feature values and read additional information about the feature such as name, type, min/max values, etc.</p>
<p>Additionally, there are functions to check availability and access status of features using the nodes.</p>
<h2><a class="anchor" id="autotoc_md32"></a>
Feature types</h2>
<p>The GenICam describes 6 different feature types:</p>
<ul>
<li>IInteger, IFloat, IBool, IString — Those are simple features, the take a value which will have some influence on the camera.</li>
<li>IEnumeration — Those features are used in two ways. Firstly, like in “PixelFormat” they can behave like an enum, the feature can only take a set amount of values. The second use case for IEnumeration features are “Selector features” here the feature is used to switch one or more other features. A good example is the “GainSelector” which selects which color-channel the “Gain” feature represents for reading or writing a value.</li>
<li>ICommand — These are features which will execute something on the camera, good examples are the “AcquisitionStart” or the “TriggerSoftware” features.</li>
</ul>
<h2><a class="anchor" id="autotoc_md33"></a>
Is the feature implemented and available?</h2>
<p>The Standard Feature Naming Convention (SFNC) describes many features a camera can implement, however not all features are implemented on all cameras. That means, before you can access a feature, you need to check if the feature is available on a camera using the <code><a class="el" href="a00032.html#gae70f642e16dc99b37a25d3288579c542" title="Returns the implemented state of node.">BGAPI2_Node_GetImplemented()</a></code> method.</p>
<div class="fragment"><div class="line"><span class="comment">// [...] includes and main() omitted, device is a valid, opened camera device pointer</span></div><div class="line"><a class="code" href="a00032.html#ga1d12f852b4519b48fa4a43631b15a5cf">BGAPI2_Node</a>* node = NULL;</div><div class="line">bo_bool flag = 0;</div><div class="line"></div><div class="line"><span class="keywordflow">if</span> (<a class="code" href="a00029.html#gafc0bdfc74d18c787b0abec69d20a0485">BGAPI2_Device_GetRemoteNode</a>(device, <span class="stringliteral">&quot;ExposureTime&quot;</span>, &amp;node) == <a class="code" href="a00040.html#gga3b6f47d8814c80ce0c600f366d531ad9aa1261e544f6188516857a20de0c41d0c">BGAPI2_RESULT_SUCCESS</a>) {</div><div class="line">    <a class="code" href="a00032.html#gae70f642e16dc99b37a25d3288579c542">BGAPI2_Node_GetImplemented</a>(node, &amp;flag);</div><div class="line">    <span class="keywordflow">if</span> (flag)</div><div class="line">        printf(<span class="stringliteral">&quot;Feature ExposureTime is implemented\n&quot;</span>);</div><div class="line">    <span class="keywordflow">else</span></div><div class="line">        printf(<span class="stringliteral">&quot;Feature ExposureTime is not implemented\n&quot;</span>);</div><div class="line">}</div><div class="line"><span class="keywordflow">else</span></div><div class="line">    printf(<span class="stringliteral">&quot;Feature ExposureTime does not exists\n&quot;</span>);</div></div><!-- fragment --> <div class="caption">Example: Check if a feature is implemented</div><p>Some features can change depending on other features set on the camera. So for example the availability of feature ExposureTime depends on the value of feature ExposureAuto. ExposureTime will only be available if the ExposureAuto is switched off. You can use the <code><a class="el" href="a00032.html#gaf272a450e0236d479f5005463c12a18f" title="Returns the availability state of node.">BGAPI2_Node_GetAvailable()</a></code> method to get the current status.</p>
<div class="fragment"><div class="line">    <span class="comment">// [...] includes and main() omitted, device is a valid, opened camera device pointer</span></div><div class="line">    <a class="code" href="a00032.html#ga1d12f852b4519b48fa4a43631b15a5cf">BGAPI2_Node</a>* node = NULL;</div><div class="line">    bo_bool flag = 0;</div><div class="line"></div><div class="line">    <span class="keywordflow">if</span> (<a class="code" href="a00029.html#gafc0bdfc74d18c787b0abec69d20a0485">BGAPI2_Device_GetRemoteNode</a>(device, <span class="stringliteral">&quot;ExposureTime&quot;</span>, &amp;node) == <a class="code" href="a00040.html#gga3b6f47d8814c80ce0c600f366d531ad9aa1261e544f6188516857a20de0c41d0c">BGAPI2_RESULT_SUCCESS</a>) {</div><div class="line">        <a class="code" href="a00032.html#gaf272a450e0236d479f5005463c12a18f">BGAPI2_Node_GetAvailable</a>(node, &amp;flag);</div><div class="line">        <span class="keywordflow">if</span> (flag)</div><div class="line">            printf(<span class="stringliteral">&quot;Feature ExposureTime is available\n&quot;</span>);</div><div class="line">        <span class="keywordflow">else</span></div><div class="line">            printf(<span class="stringliteral">&quot;Feature ExposureTime is not available\n&quot;</span>);</div><div class="line">    }</div><div class="line">    <span class="keywordflow">else</span></div><div class="line">        printf(<span class="stringliteral">&quot;Feature ExposureTime does not exists\n&quot;</span>);</div><div class="line">}</div></div><!-- fragment --> <div class="caption">Example: Check if a feature is accessible</div><h2><a class="anchor" id="autotoc_md34"></a>
Is the feature available for reading or writing?</h2>
<p>To check if a feature is readable or writable the methods <code><a class="el" href="a00032.html#gaa355f450a054a86dceb558fd5c041980" title="Returns the readability state of node.">BGAPI2_Node_IsReadable()</a></code> and <code><a class="el" href="a00032.html#ga2137ec4ed5580af2649f5561a9415641" title="Returns the writeability state of node.">BGAPI2_Node_IsWriteable()</a></code> are implemented. Some features will never be writable such as the device serial number or the model name. Other features might change their access status depending on the value of another feature. As an example, if the feature “ExposureAuto” is switched on, the feature “ExposureTime” will be set to read-only thereby ensuring nobody does interfere with the AutoExposure algorithm.</p>
<div class="fragment"><div class="line"><span class="comment">// [...] includes and main() omitted, device is a valid, opened camera device pointer</span></div><div class="line"><a class="code" href="a00032.html#ga1d12f852b4519b48fa4a43631b15a5cf">BGAPI2_Node</a>* node = NULL;</div><div class="line">bo_bool flag = 0;</div><div class="line"></div><div class="line"><span class="keywordflow">if</span> (<a class="code" href="a00029.html#gafc0bdfc74d18c787b0abec69d20a0485">BGAPI2_Device_GetRemoteNode</a>(device, <span class="stringliteral">&quot;ExposureTime&quot;</span>, &amp;node) == <a class="code" href="a00040.html#gga3b6f47d8814c80ce0c600f366d531ad9aa1261e544f6188516857a20de0c41d0c">BGAPI2_RESULT_SUCCESS</a>) {</div><div class="line">    <span class="keywordflow">if</span> (<a class="code" href="a00032.html#gaa355f450a054a86dceb558fd5c041980">BGAPI2_Node_IsReadable</a>(node, &amp;flag) == <a class="code" href="a00040.html#gga3b6f47d8814c80ce0c600f366d531ad9aa1261e544f6188516857a20de0c41d0c">BGAPI2_RESULT_SUCCESS</a> &amp;&amp; flag)</div><div class="line">        printf(<span class="stringliteral">&quot;Feature ExposureTime is readable\n&quot;</span>);</div><div class="line">    <span class="keywordflow">if</span> (<a class="code" href="a00032.html#ga2137ec4ed5580af2649f5561a9415641">BGAPI2_Node_IsWriteable</a>(node, &amp;flag) == <a class="code" href="a00040.html#gga3b6f47d8814c80ce0c600f366d531ad9aa1261e544f6188516857a20de0c41d0c">BGAPI2_RESULT_SUCCESS</a> &amp;&amp; flag)</div><div class="line">        printf(<span class="stringliteral">&quot;Feature ExposureTime is writable\n&quot;</span>);</div><div class="line">}</div><div class="line"><span class="keywordflow">else</span></div><div class="line">    printf(<span class="stringliteral">&quot;Feature ExposureTime does not exists\n&quot;</span>);</div></div><!-- fragment --> <div class="caption">Example: Check if a feature is readable or writable</div><h2><a class="anchor" id="autotoc_md35"></a>
Read and write feature values</h2>
<p>Once the feature is checked for availability and read/write-ability, reading and writing a value is trivial. There are getters and setters for different data types.</p>
<div class="fragment"><div class="line"><span class="comment">// [...] includes and main() omitted, device is a valid, opened camera device pointer</span></div><div class="line"><a class="code" href="a00032.html#ga1d12f852b4519b48fa4a43631b15a5cf">BGAPI2_Node</a>* node = NULL;</div><div class="line">bo_double value = 0;</div><div class="line"></div><div class="line"><span class="keywordflow">if</span> (<a class="code" href="a00029.html#gafc0bdfc74d18c787b0abec69d20a0485">BGAPI2_Device_GetRemoteNode</a>(device, <span class="stringliteral">&quot;ExposureTime&quot;</span>, &amp;node) == <a class="code" href="a00040.html#gga3b6f47d8814c80ce0c600f366d531ad9aa1261e544f6188516857a20de0c41d0c">BGAPI2_RESULT_SUCCESS</a>) {</div><div class="line">    <span class="keywordflow">if</span> (<a class="code" href="a00032.html#ga5ecc3defc8fc84020618ff75c759d7a5">BGAPI2_Node_GetDouble</a>(node, &amp;value) == <a class="code" href="a00040.html#gga3b6f47d8814c80ce0c600f366d531ad9aa1261e544f6188516857a20de0c41d0c">BGAPI2_RESULT_SUCCESS</a>)</div><div class="line">        printf(<span class="stringliteral">&quot;ExposureTime is set to: %lld.\n&quot;</span>, (<span class="keywordtype">long</span> <span class="keywordtype">long</span>)value);</div><div class="line">    <span class="keywordflow">if</span> (<a class="code" href="a00032.html#ga846c51e6a4e108760c029e56abb9b834">BGAPI2_Node_SetDouble</a>(node, 10000 ) == <a class="code" href="a00040.html#gga3b6f47d8814c80ce0c600f366d531ad9aa1261e544f6188516857a20de0c41d0c">BGAPI2_RESULT_SUCCESS</a>)</div><div class="line">        printf(<span class="stringliteral">&quot;Exposure Time is set to 10000 micro seconds\n&quot;</span>);</div><div class="line">}</div><div class="line"><span class="keywordflow">else</span></div><div class="line">    printf(<span class="stringliteral">&quot;Feature ExposureTime does not exists\n&quot;</span>);</div></div><!-- fragment --> <div class="caption">Example: Read and write features</div><h2><a class="anchor" id="autotoc_md36"></a>
Handling features with a set increment</h2>
<p>Features can have a minimum, maximum or increment for the allowed values set. This means it is not possible to set the full range of numbers but only a subset. A good example are the features to set a region or area of interest (ROI/AOI). The features “Width”, “Height”, “OffsetX” and “OffsetY” can typically only take values which are multiples of 2, 4, 8 or 16 and which have a maximum/minimum depending on the sensor of the camera. If an increment is set for a feature, you can check the increment using <code><a class="el" href="a00032.html#ga634ea7fad03569310ecc491b051a9f3a" title="Returns the integer increment value of node.">BGAPI2_Node_GetIntInc()</a></code> and <code><a class="el" href="a00032.html#ga2147352d505ec4c49c4525e1bfbe7b60" title="Returns the double increment value of the node.">BGAPI2_Node_GetDoubleInc()</a></code> functions.</p>
<div class="fragment"><div class="line"><span class="comment">// [...] includes and main() omitted, device is a valid, opened camera device pointer</span></div><div class="line"><a class="code" href="a00032.html#ga1d12f852b4519b48fa4a43631b15a5cf">BGAPI2_Node</a>* node = NULL;</div><div class="line"><a class="code" href="a00032.html#ga1d12f852b4519b48fa4a43631b15a5cf">BGAPI2_Node</a>* node2 = NULL;</div><div class="line">bo_uint64 value = 0;</div><div class="line"></div><div class="line"><span class="keywordflow">if</span> (<a class="code" href="a00029.html#gafc0bdfc74d18c787b0abec69d20a0485">BGAPI2_Device_GetRemoteNode</a>(device, <span class="stringliteral">&quot;Width&quot;</span>, &amp;node) == <a class="code" href="a00040.html#gga3b6f47d8814c80ce0c600f366d531ad9aa1261e544f6188516857a20de0c41d0c">BGAPI2_RESULT_SUCCESS</a>) {</div><div class="line">    <span class="keywordflow">if</span> (<a class="code" href="a00032.html#ga41ca45b7ad70d35985d1b0f1c1f7e31e">BGAPI2_Node_GetIntMin</a>(node, &amp;value) == <a class="code" href="a00040.html#gga3b6f47d8814c80ce0c600f366d531ad9aa1261e544f6188516857a20de0c41d0c">BGAPI2_RESULT_SUCCESS</a>)</div><div class="line">        printf(<span class="stringliteral">&quot;The minimum width is: %lld\n&quot;</span>, (<span class="keywordtype">long</span> <span class="keywordtype">long</span>)value);</div><div class="line">    <span class="keywordflow">if</span> (<a class="code" href="a00032.html#ga44e991c97efc3f1aaabd881752e9ea7d">BGAPI2_Node_GetIntMax</a>(node, &amp;value) == <a class="code" href="a00040.html#gga3b6f47d8814c80ce0c600f366d531ad9aa1261e544f6188516857a20de0c41d0c">BGAPI2_RESULT_SUCCESS</a>)</div><div class="line">        printf(<span class="stringliteral">&quot;The maximum width is: %lld\n&quot;</span>, (<span class="keywordtype">long</span> <span class="keywordtype">long</span>)value);</div><div class="line">    <span class="keywordflow">if</span> (<a class="code" href="a00032.html#ga634ea7fad03569310ecc491b051a9f3a">BGAPI2_Node_GetIntInc</a>(node, &amp;value) == <a class="code" href="a00040.html#gga3b6f47d8814c80ce0c600f366d531ad9aa1261e544f6188516857a20de0c41d0c">BGAPI2_RESULT_SUCCESS</a>)</div><div class="line">        printf(<span class="stringliteral">&quot;The increment for the width is: %lld\n&quot;</span>, (<span class="keywordtype">long</span> <span class="keywordtype">long</span>)value);</div><div class="line"></div><div class="line">    <span class="comment">// Stop the Acquisition so we can set the Width</span></div><div class="line">    <a class="code" href="a00029.html#gafc0bdfc74d18c787b0abec69d20a0485">BGAPI2_Device_GetRemoteNode</a>(device, <span class="stringliteral">&quot;AcquisitionStop&quot;</span>, &amp;node2);</div><div class="line">    <a class="code" href="a00032.html#ga4a8ff179abaaf701ca6208b85da234d5">BGAPI2_Node_Execute</a>(node2);</div><div class="line"></div><div class="line">    <span class="comment">// Set the width to a valid value close to 300 (just smaller)</span></div><div class="line">    bo_uint64 width = (300 / value) * value;</div><div class="line">    <span class="keywordflow">if</span> (<a class="code" href="a00032.html#gabe5c511e341f04097f75b745158046ef">BGAPI2_Node_SetInt</a>(node, width) == <a class="code" href="a00040.html#gga3b6f47d8814c80ce0c600f366d531ad9aa1261e544f6188516857a20de0c41d0c">BGAPI2_RESULT_SUCCESS</a>)</div><div class="line">        printf(<span class="stringliteral">&quot;Width is set to: %lld\n&quot;</span>, (<span class="keywordtype">long</span> <span class="keywordtype">long</span>)width);</div><div class="line">    <span class="keywordflow">else</span></div><div class="line">        printf(<span class="stringliteral">&quot;Width not writable, was the acquisition stopped before?\n&quot;</span>, (<span class="keywordtype">long</span> <span class="keywordtype">long</span>)width);</div><div class="line">}</div></div><!-- fragment --> <div class="caption">Example: min, max, increment feature values</div><p><br />
</p>
<blockquote class="doxtable">
<p><b>Attention</b></p>
<p>Some features do not have an increment but are rounded inside of a camera so writing 2.2 to the Gain feature will result in a value like 2.1877 when read back from the camera. </p>
</blockquote>
<h2><a class="anchor" id="autotoc_md37"></a>
When do changed feature settings become active?</h2>
<p>If you change the value of a feature, this might not be honored by the next image you retrieve from the camera. This can be for two reasons. Firstly, the changed feature must be written to the camera before start of the exposure, otherwise the image will be taken using the old settings. Secondly, because there is a buffer queue on the host it might be that the next image you request is already in a buffer and therefore will also be taken with older settings.</p>
<p>This behavior can especially be observed when triggering very fast or in free running mode. If this is an issue, you can avoid this firstly by executing "AcquisitionAbort" after changing the feature, this will ensure the camera does not deliver any image taking with old settings. Secondly you need to remove all buffers which might hold data taken before a feature change.</p>
<div class="fragment"><div class="line"><span class="comment">// [...] includes and main() omitted, device is a valid, opened camera device pointer</span></div><div class="line"><a class="code" href="a00030.html#ga344e24fd042e6dabd28d2b11eab6e9fe">BGAPI2_DataStream</a>* datastream = NULL;</div><div class="line"><a class="code" href="a00031.html#ga41b4fef7453483371e949a15d4da0b81">BGAPI2_Buffer</a>* buffer[5];</div><div class="line"><a class="code" href="a00032.html#ga1d12f852b4519b48fa4a43631b15a5cf">BGAPI2_Node</a>* node = NULL;</div><div class="line">bo_uint index = 0;</div><div class="line"></div><div class="line"><span class="comment">// Get the first data stream, most cameras have just one</span></div><div class="line"><span class="keywordflow">if</span> (<a class="code" href="a00029.html#ga6f8f9a70517de7e7e30120260932263d">BGAPI2_Device_GetDataStream</a>(device, 0, &amp;datastream) == <a class="code" href="a00040.html#gga3b6f47d8814c80ce0c600f366d531ad9aa1261e544f6188516857a20de0c41d0c">BGAPI2_RESULT_SUCCESS</a>) {</div><div class="line">    <span class="comment">// Open the datastream and provide 5 buffers to it</span></div><div class="line">    <a class="code" href="a00030.html#ga32a99e1e6d74150462c62e0aed721cf0">BGAPI2_DataStream_Open</a>(datastream);</div><div class="line">    <span class="keywordflow">for</span> (index = 0; index &lt; 5; index++) {</div><div class="line">        <a class="code" href="a00031.html#ga974a364adb0335d9000e2e3d8dd0c3a6">BGAPI2_CreateBuffer</a>(&amp;buffer[index]);</div><div class="line">        <a class="code" href="a00030.html#ga52ef0114ee88d904a8d030db629da94a">BGAPI2_DataStream_AnnounceBuffer</a>(datastream, buffer[index]);</div><div class="line">        <a class="code" href="a00030.html#ga613165fd182f04c8bb0c7a9f55b908af">BGAPI2_DataStream_QueueBuffer</a>(datastream, buffer[index]);</div><div class="line">    }</div><div class="line"></div><div class="line">    <span class="comment">// Start the acquisition of the camera</span></div><div class="line">    <a class="code" href="a00030.html#gae746a635a556d8598fc722e6e410dd7b">BGAPI2_DataStream_StartAcquisitionContinuous</a>(datastream);</div><div class="line">    <a class="code" href="a00029.html#gafc0bdfc74d18c787b0abec69d20a0485">BGAPI2_Device_GetRemoteNode</a>(device, <span class="stringliteral">&quot;AcquisitionStart&quot;</span>, &amp;node);</div><div class="line">    <a class="code" href="a00032.html#ga4a8ff179abaaf701ca6208b85da234d5">BGAPI2_Node_Execute</a>(node);</div><div class="line"></div><div class="line">    <span class="comment">// [...] Take some images and do feature changes</span></div><div class="line"></div><div class="line">    <span class="comment">// Now ensure that the next image comes with the settings required</span></div><div class="line">    <span class="keywordflow">if</span> (<a class="code" href="a00029.html#gafc0bdfc74d18c787b0abec69d20a0485">BGAPI2_Device_GetRemoteNode</a>(device, <span class="stringliteral">&quot;AcquisitionAbort&quot;</span>, &amp;node) == <a class="code" href="a00040.html#gga3b6f47d8814c80ce0c600f366d531ad9aa1261e544f6188516857a20de0c41d0c">BGAPI2_RESULT_SUCCESS</a>) {</div><div class="line">        <a class="code" href="a00032.html#ga4a8ff179abaaf701ca6208b85da234d5">BGAPI2_Node_Execute</a>(node);  <span class="comment">// Abort the current image in the camera</span></div><div class="line">        <a class="code" href="a00030.html#ga10a92aee47b872956d2d6921f293f98d">BGAPI2_DataStream_FlushAllToInputQueue</a>(datastream); <span class="comment">// Abort the current image in the camera</span></div><div class="line"></div><div class="line">        <span class="comment">// Re-start the acquisition of the camera</span></div><div class="line">        <a class="code" href="a00030.html#gae746a635a556d8598fc722e6e410dd7b">BGAPI2_DataStream_StartAcquisitionContinuous</a>(datastream);</div><div class="line">        <a class="code" href="a00029.html#gafc0bdfc74d18c787b0abec69d20a0485">BGAPI2_Device_GetRemoteNode</a>(device, <span class="stringliteral">&quot;AcquisitionStart&quot;</span>, &amp;node);</div><div class="line">        <a class="code" href="a00032.html#ga4a8ff179abaaf701ca6208b85da234d5">BGAPI2_Node_Execute</a>(node);</div><div class="line">    }</div><div class="line"></div><div class="line">    <span class="comment">// [...] Take new images with new settings</span></div><div class="line">}</div></div><!-- fragment --> <div class="caption">Example: Feature setting to image synchronization</div><h2><a class="anchor" id="autotoc_md38"></a>
Execute ICommand features</h2>
<p>One special category are features which execute something on the camera. Examples are the software trigger or the acquisition start/stop features.</p>
<div class="fragment"><div class="line"><span class="comment">// [...] includes and main() omitted, device is a valid, opened camera device pointer</span></div><div class="line"><a class="code" href="a00030.html#ga344e24fd042e6dabd28d2b11eab6e9fe">BGAPI2_DataStream</a>* datastream = NULL;                        <span class="comment">// Create the pointer for the data stream</span></div><div class="line"><a class="code" href="a00031.html#ga41b4fef7453483371e949a15d4da0b81">BGAPI2_Buffer</a>* buffer;                                       <span class="comment">// Create the pointer for the image buffer</span></div><div class="line"><a class="code" href="a00032.html#ga1d12f852b4519b48fa4a43631b15a5cf">BGAPI2_Node</a>* node = NULL;</div><div class="line">bo_bool flag = 0;</div><div class="line"></div><div class="line"><span class="comment">// Open the data stream</span></div><div class="line"><a class="code" href="a00029.html#ga6f8f9a70517de7e7e30120260932263d">BGAPI2_Device_GetDataStream</a>(device, 0, &amp;datastream);         <span class="comment">// We want to use the first data stream</span></div><div class="line"><a class="code" href="a00030.html#ga32a99e1e6d74150462c62e0aed721cf0">BGAPI2_DataStream_Open</a>(datastream);                          <span class="comment">// Open the data stream to use it</span></div><div class="line"></div><div class="line"><span class="comment">// Create and queue buffer</span></div><div class="line"><a class="code" href="a00031.html#ga974a364adb0335d9000e2e3d8dd0c3a6">BGAPI2_CreateBuffer</a>(&amp;buffer);                                <span class="comment">// Create a buffer</span></div><div class="line"><a class="code" href="a00030.html#ga52ef0114ee88d904a8d030db629da94a">BGAPI2_DataStream_AnnounceBuffer</a>(datastream, buffer);        <span class="comment">// Announce the buffer to the datastream</span></div><div class="line"><a class="code" href="a00030.html#ga613165fd182f04c8bb0c7a9f55b908af">BGAPI2_DataStream_QueueBuffer</a>(datastream, buffer);           <span class="comment">// Queue the buffer to be used</span></div><div class="line"></div><div class="line"><span class="comment">// Start the acquisition of the camera</span></div><div class="line"><a class="code" href="a00030.html#gae746a635a556d8598fc722e6e410dd7b">BGAPI2_DataStream_StartAcquisitionContinuous</a>(datastream);</div><div class="line"><a class="code" href="a00029.html#gafc0bdfc74d18c787b0abec69d20a0485">BGAPI2_Device_GetRemoteNode</a>(device, <span class="stringliteral">&quot;AcquisitionStart&quot;</span>, &amp;node); <span class="comment">// Get a executable feature</span></div><div class="line"><a class="code" href="a00032.html#ga4a8ff179abaaf701ca6208b85da234d5">BGAPI2_Node_Execute</a>(node);                                      <span class="comment">// Execute the feature</span></div><div class="line"></div><div class="line"><span class="keywordflow">while</span> (!flag)                                                   <span class="comment">// Wait for the execution to finish</span></div><div class="line">{</div><div class="line">    <a class="code" href="a00032.html#gafe98a57c9aa4405b69c0e5b0f6e5f6aa">BGAPI2_Node_IsDone</a>(node, &amp;flag);</div><div class="line">    printf(<span class="stringliteral">&quot;.&quot;</span>);</div><div class="line">}</div></div><!-- fragment --> <div class="caption">Example: Working with an executable feature</div><h2><a class="anchor" id="autotoc_md39"></a>
Using IEnumeration features</h2>
<p>Another special case are enumeration features. They can be two different things, either a “selector feature” such as the “GainSelector” which is used to change other features on the camera, or an enumeration like the “PixelFormat” which can only be assigned a set number of values.</p>
<p>The example below shows, how to loop through the possible values of the PixelFormat feature. With the call <code><a class="el" href="a00032.html#gaa355f450a054a86dceb558fd5c041980" title="Returns the readability state of node.">BGAPI2_Node_IsReadable()</a></code> we check two things, firstly if the feature PixelFormat is not locked, that could be the case if the Acquisition is not stopped. Secondly we check if a value allowed, meaning that the camera implements the functionality behind it.</p>
<div class="fragment"><div class="line"><span class="comment">// [...] includes and main() omitted, device is a valid, opened camera device pointer</span></div><div class="line"><a class="code" href="a00032.html#ga1d12f852b4519b48fa4a43631b15a5cf">BGAPI2_Node</a>* node = NULL;</div><div class="line"><a class="code" href="a00033.html#ga61c581a87119b43d84e38b77d211d3a1">BGAPI2_NodeMap</a>* nodemap = NULL;</div><div class="line">bo_uint64 mapsize = 0;</div><div class="line">bo_uint64 stringsize = 0;</div><div class="line"><span class="keywordtype">char</span>* stringvalue = NULL;</div><div class="line">bo_bool flag = 0;</div><div class="line">bo_uint index = 0;</div><div class="line"></div><div class="line"><span class="comment">// Get the PixelFormat feature and its value as a string</span></div><div class="line"><a class="code" href="a00029.html#gafc0bdfc74d18c787b0abec69d20a0485">BGAPI2_Device_GetRemoteNode</a>(device, <span class="stringliteral">&quot;PixelFormat&quot;</span>, &amp;node);</div><div class="line"><a class="code" href="a00032.html#gaedf30c684d6784cf470cdae7a8367e0d">BGAPI2_Node_GetString</a>(node, NULL, &amp;stringsize);         <span class="comment">// Get string size so we can reserve required memory</span></div><div class="line">printf(<span class="stringliteral">&quot;PixelFormat string size: %lld&quot;</span>, (<span class="keywordtype">long</span> <span class="keywordtype">long</span>)stringsize);</div><div class="line">stringvalue = malloc(stringsize);                       <span class="comment">// Now allocate the memory</span></div><div class="line"><a class="code" href="a00032.html#gaedf30c684d6784cf470cdae7a8367e0d">BGAPI2_Node_GetString</a>(node, stringvalue, &amp;stringsize);  <span class="comment">// Get the value of the feature</span></div><div class="line">printf(<span class="stringliteral">&quot;, value: %s.\n&quot;</span>, stringvalue);</div><div class="line">free(stringvalue);</div><div class="line"></div><div class="line"><a class="code" href="a00032.html#ga120035f6e1ef1e6c2fb9a1cf2b5a3540">BGAPI2_Node_GetEnumNodeList</a>(node, &amp;nodemap);            <span class="comment">// Get the list of possible enums</span></div><div class="line"><a class="code" href="a00033.html#ga9f17d94ca50cbaeed876d8da736e1688">BGAPI2_NodeMap_GetNodeCount</a>(nodemap, &amp;mapsize);         <span class="comment">// Get the enum count</span></div><div class="line"></div><div class="line"><span class="comment">// Loop through the enum list and check which ones are readable, meaning which can be applied.</span></div><div class="line"><span class="comment">// If the enum is not readable, it could be that the PixelFormat feature is locked, or that</span></div><div class="line"><span class="comment">// the specific enum is not implemented on the camera</span></div><div class="line"><span class="keywordflow">for</span> (index = 0; index &lt; mapsize; index++) {</div><div class="line">    <a class="code" href="a00033.html#ga6ad793fefefe467ec743b460834b4b0f">BGAPI2_NodeMap_GetNodeByIndex</a>(nodemap, index, &amp;node);</div><div class="line">    <a class="code" href="a00032.html#gaedf30c684d6784cf470cdae7a8367e0d">BGAPI2_Node_GetString</a>(node, NULL, &amp;stringsize);</div><div class="line">    printf(<span class="stringliteral">&quot;String size: %lld&quot;</span>, (<span class="keywordtype">long</span> <span class="keywordtype">long</span>)stringsize);</div><div class="line">    stringvalue = malloc(stringsize);</div><div class="line">    <a class="code" href="a00032.html#gaedf30c684d6784cf470cdae7a8367e0d">BGAPI2_Node_GetString</a>(node, stringvalue, &amp;stringsize);</div><div class="line"></div><div class="line">    <span class="comment">// Check if the feature is implemented and readable</span></div><div class="line">    <a class="code" href="a00032.html#gaa355f450a054a86dceb558fd5c041980">BGAPI2_Node_IsReadable</a>(node, &amp;flag);</div><div class="line">    <span class="keywordflow">if</span> (flag)</div><div class="line">        printf(<span class="stringliteral">&quot;, value: %s.\n&quot;</span>, stringvalue);</div><div class="line">    <span class="keywordflow">else</span></div><div class="line">        printf(<span class="stringliteral">&quot;, value: %s is not available.\n&quot;</span>, stringvalue);</div><div class="line"></div><div class="line">    free(stringvalue);</div><div class="line">}</div></div><!-- fragment --> <div class="caption">Example: Working with the PixelFormat feature (enumeration feature)</div><p>The next example shows how a selector feature is used to access a set of similar features. A camera can have more than one GPIO line, each of the lines has a set of attributes. To access them for one of the GPIO lines we set the LineSelector to this line and can than read or write the attributes of this line.</p>
<div class="fragment"><div class="line"><span class="comment">// [...] includes and main() omitted, device is a valid, opened camera device pointer</span></div><div class="line"><a class="code" href="a00032.html#ga1d12f852b4519b48fa4a43631b15a5cf">BGAPI2_Node</a>* node = NULL;</div><div class="line"><a class="code" href="a00032.html#ga1d12f852b4519b48fa4a43631b15a5cf">BGAPI2_Node</a>* node2 = NULL;</div><div class="line"><a class="code" href="a00033.html#ga61c581a87119b43d84e38b77d211d3a1">BGAPI2_NodeMap</a>* nodemap = NULL;</div><div class="line"><span class="keywordtype">char</span> value[256] = <span class="stringliteral">&quot;&quot;</span>;</div><div class="line">bo_int length = 256;</div><div class="line">bo_int nodecount = 0;</div><div class="line">bo_int index = 0;</div><div class="line">bo_bool flag = 0;</div><div class="line"></div><div class="line"><a class="code" href="a00029.html#gafc0bdfc74d18c787b0abec69d20a0485">BGAPI2_Device_GetRemoteNode</a>(device, <span class="stringliteral">&quot;LineSelector&quot;</span>, &amp;node);</div><div class="line">length = <span class="keyword">sizeof</span>(value);</div><div class="line"><a class="code" href="a00032.html#gaedf30c684d6784cf470cdae7a8367e0d">BGAPI2_Node_GetString</a>(node, value, &amp;length);</div><div class="line">printf(<span class="stringliteral">&quot;Current value of the LineSelector is: %s\n\n&quot;</span>, value);</div><div class="line"><a class="code" href="a00032.html#gaa67a3dc11f62d6b7a7b942bb4856f74a">BGAPI2_Node_SetString</a>(node, <span class="stringliteral">&quot;Line1&quot;</span>);</div><div class="line"></div><div class="line"><a class="code" href="a00032.html#ga120035f6e1ef1e6c2fb9a1cf2b5a3540">BGAPI2_Node_GetEnumNodeList</a>(node, &amp;nodemap);                <span class="comment">// Get the list of available values</span></div><div class="line"><a class="code" href="a00033.html#ga9f17d94ca50cbaeed876d8da736e1688">BGAPI2_NodeMap_GetNodeCount</a>(nodemap, &amp;nodecount);           <span class="comment">// Get the count of values</span></div><div class="line"><span class="keywordflow">for</span> (index = 0; index &lt; nodecount; index++) {               <span class="comment">// Loop through the values</span></div><div class="line">    <a class="code" href="a00033.html#ga6ad793fefefe467ec743b460834b4b0f">BGAPI2_NodeMap_GetNodeByIndex</a>(nodemap, index, &amp;node2);</div><div class="line">    length = <span class="keyword">sizeof</span>(value);</div><div class="line">    <a class="code" href="a00032.html#gaedf30c684d6784cf470cdae7a8367e0d">BGAPI2_Node_GetString</a>(node2, value, &amp;length);</div><div class="line"></div><div class="line">    <a class="code" href="a00032.html#gaa355f450a054a86dceb558fd5c041980">BGAPI2_Node_IsReadable</a>(node2, &amp;flag);                   <span class="comment">// Check if the feature is implemented and readable</span></div><div class="line">    <span class="keywordflow">if</span> (flag)</div><div class="line">        printf(<span class="stringliteral">&quot;Available value: %s.\n&quot;</span>, value);</div><div class="line">    <span class="keywordflow">else</span></div><div class="line">        printf(<span class="stringliteral">&quot;Value: %s is not available.\n&quot;</span>, value);</div><div class="line">}</div><div class="line"></div><div class="line"><a class="code" href="a00032.html#gae52ccaf5bb8010ff78f645a2c8da8056">BGAPI2_Node_GetSelectedFeatures</a>(node, &amp;nodemap);            <span class="comment">// Get the list of connected features</span></div><div class="line"><a class="code" href="a00033.html#ga9f17d94ca50cbaeed876d8da736e1688">BGAPI2_NodeMap_GetNodeCount</a>(nodemap, &amp;nodecount);</div><div class="line"><span class="keywordflow">for</span> (index = 0; index &lt; nodecount; index++) {               <span class="comment">// Loop through the features</span></div><div class="line">    <a class="code" href="a00033.html#ga6ad793fefefe467ec743b460834b4b0f">BGAPI2_NodeMap_GetNodeByIndex</a>(nodemap, index, &amp;node2);</div><div class="line">    length = <span class="keyword">sizeof</span>(value);</div><div class="line">    <a class="code" href="a00032.html#gaa8bc79379422150ac3d9e8d0e1103931">BGAPI2_Node_GetDisplayname</a>(node2, value, &amp;length);      <span class="comment">// Print the display name for the feature</span></div><div class="line">    printf(<span class="stringliteral">&quot;Connected feature: %s.\n&quot;</span>, value);</div><div class="line">}</div></div><!-- fragment --> <div class="caption">Example: Working with a selector feature (GainSelector)</div><h2><a class="anchor" id="autotoc_md40"></a>
Further feature attributes</h2>
<p>Each feature has a set of methods which should make it easy to use them for calculations or in a GUI. The available methods do depend on the type of the feature.</p>
<div class="fragment"><div class="line"><span class="comment">// [...] includes and main() omitted, device is a valid, opened camera device pointer</span></div><div class="line"><a class="code" href="a00032.html#ga1d12f852b4519b48fa4a43631b15a5cf">BGAPI2_Node</a>* node = NULL;</div><div class="line">bo_int64 intvalue = 0;</div><div class="line">bo_bool flag = 0;</div><div class="line">bo_int64 strsize = 0;</div><div class="line"><span class="keywordtype">char</span> strvalue[1024] = <span class="stringliteral">&quot;&quot;</span>;</div><div class="line"></div><div class="line"><span class="comment">// IString feature functions</span></div><div class="line"><a class="code" href="a00029.html#gafc0bdfc74d18c787b0abec69d20a0485">BGAPI2_Device_GetRemoteNode</a>(device, <span class="stringliteral">&quot;DeviceUserID&quot;</span>, &amp;node);</div><div class="line"><a class="code" href="a00032.html#gaa67a3dc11f62d6b7a7b942bb4856f74a">BGAPI2_Node_SetString</a>(node, <span class="stringliteral">&quot;MyCamera&quot;</span>);                            <span class="comment">// Set the DeviceUserID to &quot;MyCamera&quot;</span></div><div class="line"></div><div class="line">strsize = <span class="keyword">sizeof</span>(strvalue);</div><div class="line"><a class="code" href="a00032.html#gaedf30c684d6784cf470cdae7a8367e0d">BGAPI2_Node_GetString</a>(node, strvalue, &amp;strsize);                    <span class="comment">// Get the value back as a String</span></div><div class="line">printf(<span class="stringliteral">&quot;String value: %s\n&quot;</span>, strvalue);</div><div class="line"></div><div class="line"><a class="code" href="a00032.html#gae6c09180c0d1899d4d1068d34f2757cb">BGAPI2_Node_GetMaxStringLength</a>(node, &amp;strsize);                     <span class="comment">// Get the maximum length of the string</span></div><div class="line">printf(<span class="stringliteral">&quot;Max String size: %lld\n&quot;</span>, (<span class="keywordtype">long</span> <span class="keywordtype">long</span>)strsize);</div><div class="line"></div><div class="line"><span class="comment">// IInteger, IFloat or IBool feature methods</span></div><div class="line"><a class="code" href="a00029.html#gafc0bdfc74d18c787b0abec69d20a0485">BGAPI2_Device_GetRemoteNode</a>(device, <span class="stringliteral">&quot;Width&quot;</span>, &amp;node);</div><div class="line"></div><div class="line"><a class="code" href="a00032.html#ga2219205db922217895da295f73ecd0dd">BGAPI2_Node_GetInt</a>(node, &amp;intvalue);                                <span class="comment">// Get the value as an Integer</span></div><div class="line">printf(<span class="stringliteral">&quot;Integer value: %lld\n&quot;</span>, (<span class="keywordtype">long</span> <span class="keywordtype">long</span>)intvalue);</div><div class="line"><a class="code" href="a00032.html#ga41ca45b7ad70d35985d1b0f1c1f7e31e">BGAPI2_Node_GetIntMin</a>(node, &amp;intvalue);                             <span class="comment">// Get the smallest possible value</span></div><div class="line">printf(<span class="stringliteral">&quot;Minimum Integer value: %lld\n&quot;</span>, (<span class="keywordtype">long</span> <span class="keywordtype">long</span>)intvalue);</div><div class="line"><a class="code" href="a00032.html#ga44e991c97efc3f1aaabd881752e9ea7d">BGAPI2_Node_GetIntMax</a>(node, &amp;intvalue);                             <span class="comment">// Get the largest possible value</span></div><div class="line">printf(<span class="stringliteral">&quot;Maximum Integer value: %lld\n&quot;</span>, (<span class="keywordtype">long</span> <span class="keywordtype">long</span>)intvalue);</div><div class="line"><a class="code" href="a00032.html#ga634ea7fad03569310ecc491b051a9f3a">BGAPI2_Node_GetIntInc</a>(node, &amp;intvalue);                             <span class="comment">// Get the increment to the next possible value</span></div><div class="line">printf(<span class="stringliteral">&quot;Increment Integer value: %lld\n&quot;</span>, (<span class="keywordtype">long</span> <span class="keywordtype">long</span>)intvalue);</div><div class="line"></div><div class="line">flag = 0;</div><div class="line"><a class="code" href="a00032.html#ga34aabe038ff4fc06c074e787438c02c4">BGAPI2_Node_HasUnit</a>(node, &amp;flag);                                   <span class="comment">// Check if the feature has a unit</span></div><div class="line"><span class="keywordflow">if</span> (flag) {</div><div class="line">    strsize = <span class="keyword">sizeof</span>(strvalue);</div><div class="line">    <a class="code" href="a00032.html#gaada3e12d718054d0ff902918a73996c9">BGAPI2_Node_GetUnit</a>(node, strvalue, &amp;strsize);                  <span class="comment">// Get a string with the unit to be displayed</span></div><div class="line">    printf(<span class="stringliteral">&quot;Unit: %s\n&quot;</span>, strvalue);</div><div class="line">}</div><div class="line"></div><div class="line">strsize = <span class="keyword">sizeof</span>(strvalue);</div><div class="line"><a class="code" href="a00032.html#gad2ccc830a1b0e5dc74569e4475bfd6eb">BGAPI2_Node_GetRepresentation</a>(node, strvalue, &amp;strsize);            <span class="comment">// How should the data be presented (linear, logarithmic, number)</span></div><div class="line">printf(<span class="stringliteral">&quot;Representation: %s\n&quot;</span>, strvalue);</div><div class="line"></div><div class="line"><span class="comment">// Feature attributes available for all feature types</span></div><div class="line">strsize = <span class="keyword">sizeof</span>(strvalue);</div><div class="line"><a class="code" href="a00032.html#gaedf30c684d6784cf470cdae7a8367e0d">BGAPI2_Node_GetString</a>(node, strvalue, &amp;strsize);                    <span class="comment">// Get the value back as a String</span></div><div class="line">printf(<span class="stringliteral">&quot;Value as string: %s\n&quot;</span>, strvalue);</div><div class="line"></div><div class="line">strsize = <span class="keyword">sizeof</span>(strvalue);</div><div class="line"><a class="code" href="a00032.html#ga59bd81d78516d6e8b9fb6e84511601ad">BGAPI2_Node_GetName</a>(node, strvalue, &amp;strsize);                      <span class="comment">// Get the name of the feature (CamelCase)</span></div><div class="line">printf(<span class="stringliteral">&quot;Name: %s\n&quot;</span>, strvalue);</div><div class="line"></div><div class="line">strsize = <span class="keyword">sizeof</span>(strvalue);</div><div class="line"><a class="code" href="a00032.html#gaa8bc79379422150ac3d9e8d0e1103931">BGAPI2_Node_GetDisplayname</a>(node, strvalue, &amp;strsize);               <span class="comment">// Get the name as it should be displayed (with spaces)</span></div><div class="line">printf(<span class="stringliteral">&quot;Displayname: %s\n&quot;</span>, strvalue);</div><div class="line"></div><div class="line">strsize = <span class="keyword">sizeof</span>(strvalue);</div><div class="line"><a class="code" href="a00032.html#ga707adb63ee4f84a7abcdcc05252aab92">BGAPI2_Node_GetToolTip</a>(node, strvalue, &amp;strsize);                   <span class="comment">// Get a short description of the feature</span></div><div class="line">printf(<span class="stringliteral">&quot;Tool Tip: %s\n&quot;</span>, strvalue);</div><div class="line"></div><div class="line">strsize = <span class="keyword">sizeof</span>(strvalue);</div><div class="line"><a class="code" href="a00032.html#gad694b844fa823fdd49711d3cacb4c6d0">BGAPI2_Node_GetDescription</a>(node, strvalue, &amp;strsize);               <span class="comment">// Get a longer description of the feature</span></div><div class="line">printf(<span class="stringliteral">&quot;Description: %s\n&quot;</span>, strvalue);</div><div class="line"></div><div class="line"><span class="comment">// Check the access mode</span></div><div class="line">flag = 0;</div><div class="line"><a class="code" href="a00032.html#gaf272a450e0236d479f5005463c12a18f">BGAPI2_Node_GetAvailable</a>(node, &amp;flag);</div><div class="line"><span class="keywordflow">if</span> (flag) printf(<span class="stringliteral">&quot;Feature is available\n&quot;</span>);</div><div class="line">flag = 0;</div><div class="line"><a class="code" href="a00032.html#gae70f642e16dc99b37a25d3288579c542">BGAPI2_Node_GetImplemented</a>(node, &amp;flag);</div><div class="line"><span class="keywordflow">if</span> (flag) printf(<span class="stringliteral">&quot;Feature is implemented\n&quot;</span>);</div><div class="line">flag = 0;</div><div class="line"><a class="code" href="a00032.html#gaa355f450a054a86dceb558fd5c041980">BGAPI2_Node_IsReadable</a>(node, &amp;flag);</div><div class="line"><span class="keywordflow">if</span> (flag) printf(<span class="stringliteral">&quot;Feature is readable\n&quot;</span>);</div><div class="line">flag = 0;</div><div class="line"><a class="code" href="a00032.html#ga2137ec4ed5580af2649f5561a9415641">BGAPI2_Node_IsWriteable</a>(node, &amp;flag);</div><div class="line"><span class="keywordflow">if</span> (flag) printf(<span class="stringliteral">&quot;Feature is writable\n&quot;</span>);</div><div class="line"></div><div class="line">strsize = <span class="keyword">sizeof</span>(strvalue);</div><div class="line"><a class="code" href="a00032.html#ga3ad7936706faf196e399e099d78bbbb6">BGAPI2_Node_GetInterface</a>(node, strvalue, &amp;strsize);                 <span class="comment">// Get the GenICam interface (type) of the current feature</span></div><div class="line">printf(<span class="stringliteral">&quot;Interface: %s\n&quot;</span>, strvalue);</div><div class="line"></div><div class="line">strsize = <span class="keyword">sizeof</span>(strvalue);</div><div class="line"><a class="code" href="a00032.html#ga07550670a7a2fabf870f065a9b12c127">BGAPI2_Node_GetVisibility</a>(node, strvalue, &amp;strsize);                <span class="comment">// Get the GenICam recommended level (beginner, expert, guru)</span></div><div class="line">printf(<span class="stringliteral">&quot;Interface: %s\n&quot;</span>, strvalue);</div></div><!-- fragment --> <div class="caption">Example: Working with a additional feature methods</div><p><a class="anchor" id="Images_and_buffers"></a></p>
<h1><a class="anchor" id="autotoc_md41"></a>
Images and buffers</h1>
<p>Now that you have a camera connected and know how to change camera settings via the features, it is time to get some images. To get to your first image is straight forward. Please be aware, that the Baumer GAPI does not provide functionality to display or save images. Please use your preferred framework (like OpenCV) for those tasks.</p>
<div class="fragment"><div class="line"><span class="comment">// [...] includes and main() omitted, device is a valid, opened camera device pointer</span></div><div class="line"><a class="code" href="a00030.html#ga344e24fd042e6dabd28d2b11eab6e9fe">BGAPI2_DataStream</a>* datastream = NULL;</div><div class="line"><a class="code" href="a00031.html#ga41b4fef7453483371e949a15d4da0b81">BGAPI2_Buffer</a>* buffer = NULL;</div><div class="line"><a class="code" href="a00032.html#ga1d12f852b4519b48fa4a43631b15a5cf">BGAPI2_Node</a>* node = NULL;</div><div class="line"></div><div class="line"><a class="code" href="a00029.html#ga6f8f9a70517de7e7e30120260932263d">BGAPI2_Device_GetDataStream</a>(device, 0, &amp;datastream);       <span class="comment">// We want to use the first data stream</span></div><div class="line"><a class="code" href="a00030.html#ga32a99e1e6d74150462c62e0aed721cf0">BGAPI2_DataStream_Open</a>(datastream);                        <span class="comment">// Open the data stream to use it</span></div><div class="line"><a class="code" href="a00031.html#ga974a364adb0335d9000e2e3d8dd0c3a6">BGAPI2_CreateBuffer</a>(&amp;buffer);                              <span class="comment">// Create a buffer</span></div><div class="line"><a class="code" href="a00030.html#ga52ef0114ee88d904a8d030db629da94a">BGAPI2_DataStream_AnnounceBuffer</a>(datastream, buffer);      <span class="comment">// Announce the buffer to the datastream</span></div><div class="line"><a class="code" href="a00030.html#ga613165fd182f04c8bb0c7a9f55b908af">BGAPI2_DataStream_QueueBuffer</a>(datastream, buffer);         <span class="comment">// Queue the buffer to be used</span></div><div class="line"></div><div class="line"><a class="code" href="a00030.html#gab7550ba5991e96dccddcdbdca967e83c">BGAPI2_DataStream_StartAcquisition</a>(datastream, 1);         <span class="comment">// Acquire one image from the camera</span></div><div class="line"><a class="code" href="a00029.html#gafc0bdfc74d18c787b0abec69d20a0485">BGAPI2_Device_GetRemoteNode</a>(device, <span class="stringliteral">&quot;AcquisitionStart&quot;</span>, &amp;node);  <span class="comment">// Get the node &quot;AcquisitionStart&quot;</span></div><div class="line"><a class="code" href="a00032.html#ga4a8ff179abaaf701ca6208b85da234d5">BGAPI2_Node_Execute</a>(node);                                 <span class="comment">// Execute the node</span></div><div class="line"></div><div class="line"><a class="code" href="a00031.html#ga41b4fef7453483371e949a15d4da0b81">BGAPI2_Buffer</a>* bufferfilled = NULL;                        <span class="comment">// Create the pointer for the buffer to fill</span></div><div class="line"><a class="code" href="a00030.html#ga76bcbef15426477683bed38ca84376a6">BGAPI2_DataStream_GetFilledBuffer</a>(datastream, &amp;bufferfilled, 1000); <span class="comment">// Get the image into the buffer provided</span></div><div class="line"></div><div class="line">bo_uint64 frameID = 9999;                                  <span class="comment">// Set the frameID to something arbitary</span></div><div class="line"><a class="code" href="a00031.html#gaa47d9986c6175ddea20f337e4208ca08">BGAPI2_Buffer_GetFrameID</a>(bufferfilled, &amp;frameID);          <span class="comment">// Get the frame counter from the camera to check</span></div><div class="line">                                                           <span class="comment">// if the buffer holds an image.</span></div><div class="line">printf(<span class="stringliteral">&quot;Frame ID: %lld&quot;</span>, (<span class="keywordtype">long</span> <span class="keywordtype">long</span>)frameID);              <span class="comment">// Print bufferID (0 or 1 depending on the camera)</span></div></div><!-- fragment --> <div class="caption">Example: Retrieve an image into an buffer</div><h2><a class="anchor" id="autotoc_md42"></a>
How are images transferred to the application?</h2>
<p>Firstly, there are two different modes a GenICam camera can be operated in. The camera can either be in “free-run” mode, where the camera will constantly supply images. Secondly, there is the trigger mode where you need to tell the camera to take an image either via software command feature “TriggerSoftware” or via a hardware trigger impulse where the source is set via the feature “TriggerSource”.</p>
<div class="fragment"><div class="line"><span class="comment">// [...] includes and main() omitted, device is a valid, opened camera device pointer</span></div><div class="line"><a class="code" href="a00032.html#ga1d12f852b4519b48fa4a43631b15a5cf">BGAPI2_Node</a>* node = NULL;</div><div class="line"></div><div class="line"><span class="comment">// Set the camera to triggered mode</span></div><div class="line"><a class="code" href="a00029.html#gafc0bdfc74d18c787b0abec69d20a0485">BGAPI2_Device_GetRemoteNode</a>(device, <span class="stringliteral">&quot;TriggerMode&quot;</span>, &amp;node);</div><div class="line"><a class="code" href="a00032.html#gaa67a3dc11f62d6b7a7b942bb4856f74a">BGAPI2_Node_SetString</a>(node, <span class="stringliteral">&quot;On&quot;</span>);</div><div class="line"><a class="code" href="a00029.html#gafc0bdfc74d18c787b0abec69d20a0485">BGAPI2_Device_GetRemoteNode</a>(device, <span class="stringliteral">&quot;TriggerSource&quot;</span>, &amp;node);</div><div class="line"><a class="code" href="a00032.html#gaa67a3dc11f62d6b7a7b942bb4856f74a">BGAPI2_Node_SetString</a>(node, <span class="stringliteral">&quot;All&quot;</span>);                                <span class="comment">// Alternatively use &quot;Software&quot; or &quot;Line 0&quot;</span></div><div class="line"><a class="code" href="a00029.html#gafc0bdfc74d18c787b0abec69d20a0485">BGAPI2_Device_GetRemoteNode</a>(device, <span class="stringliteral">&quot;TriggerSoftware&quot;</span>, &amp;node);</div><div class="line"><a class="code" href="a00032.html#ga4a8ff179abaaf701ca6208b85da234d5">BGAPI2_Node_Execute</a>(node);</div><div class="line"></div><div class="line"><span class="comment">// Set the camera to free running mode (default)</span></div><div class="line"><a class="code" href="a00029.html#gafc0bdfc74d18c787b0abec69d20a0485">BGAPI2_Device_GetRemoteNode</a>(device, <span class="stringliteral">&quot;TriggerMode&quot;</span>, &amp;node);</div><div class="line"><a class="code" href="a00032.html#gaa67a3dc11f62d6b7a7b942bb4856f74a">BGAPI2_Node_SetString</a>(node, <span class="stringliteral">&quot;Off&quot;</span>);</div><div class="line"><a class="code" href="a00029.html#gafc0bdfc74d18c787b0abec69d20a0485">BGAPI2_Device_GetRemoteNode</a>(device, <span class="stringliteral">&quot;AcquisitionFrameRateEnable&quot;</span>, &amp;node);   <span class="comment">// Optional to fix the frame rate</span></div><div class="line"><a class="code" href="a00032.html#gabe5c511e341f04097f75b745158046ef">BGAPI2_Node_SetInt</a>(node, 1);</div><div class="line"><a class="code" href="a00029.html#gafc0bdfc74d18c787b0abec69d20a0485">BGAPI2_Device_GetRemoteNode</a>(device, <span class="stringliteral">&quot;AcquisitionFrameRate&quot;</span>, &amp;node);         <span class="comment">// Optional, the fixed frame rate</span></div><div class="line"><a class="code" href="a00032.html#ga846c51e6a4e108760c029e56abb9b834">BGAPI2_Node_SetDouble</a>(node, 24);</div></div><!-- fragment --> <div class="caption">Example: Change the camera behavior from triggered to free-run</div><p>The transfer of the images from the camera is the most critical process. It needs to be reliable so no image gets lost. It also needs to be really quick, as a single camera can already deliver up to 10 GBits of data per second to the host. Furthermore, the mechanics of the image transfer needs some flexibility as the host operating system is not a real-time OS, which means, we don't know exactly when the application will be scheduled next for work. And finally, to be able to process the data at high speeds, it is necessary to enable parallel execution of image processing.</p>
<p>To deal with those issues, a buffer queue is implemented. In the beginning, all those buffers are empty. Calling <code><a class="el" href="a00030.html#ga76bcbef15426477683bed38ca84376a6" title="Fetches a new image from the DataStream object and removes it from the output buffer queue.">BGAPI2_DataStream_GetFilledBuffer()</a></code> on an empty buffer queue will result in an empty image. For the camera to deliver an image to the host, an empty buffer must be lined up to receive an image. If no empty buffer is available, the camera will produce so called under-runs and will drop the image. Once the camera can deliver an image to a buffer, it will be placed in the queue of filled buffers. On calling <code><a class="el" href="a00030.html#ga76bcbef15426477683bed38ca84376a6" title="Fetches a new image from the DataStream object and removes it from the output buffer queue.">BGAPI2_DataStream_GetFilledBuffer()</a></code>, one of the filled buffers is given to the user.</p>
<p>At this point, the buffer is delivered directly to you, to be used in your application without further copying (copying of large data blocks is slow!). The buffer is owned by you and is not available for the Baumer GAPI to store a new image. Therefore, you need to ensure that you always return buffers back to the buffer queue using the <code><a class="el" href="a00030.html#ga613165fd182f04c8bb0c7a9f55b908af" title="Moves a Buffer object into the input buffer queue and make it available for the image acquisition.">BGAPI2_DataStream_QueueBuffer()</a></code> function.</p>
<p>You need to setup the required buffers and provide them to the DataStream for usage. Depending on your application you might change the amount of buffers to use, especially if working with high frame-rates. The example below will fail with an <code>NoImageBufferException</code> after 8 images as the example code never returns any buffer back to the Baumer GAPI.</p>
<div class="fragment"><div class="line"><span class="comment">// [...] includes and main() omitted, device is a valid, opened camera device pointer</span></div><div class="line"><a class="code" href="a00030.html#ga344e24fd042e6dabd28d2b11eab6e9fe">BGAPI2_DataStream</a>* datastream = NULL;</div><div class="line"><a class="code" href="a00031.html#ga41b4fef7453483371e949a15d4da0b81">BGAPI2_Buffer</a>* buffer[5];</div><div class="line"><a class="code" href="a00031.html#ga41b4fef7453483371e949a15d4da0b81">BGAPI2_Buffer</a>* bufferfilled[10];</div><div class="line"><a class="code" href="a00032.html#ga1d12f852b4519b48fa4a43631b15a5cf">BGAPI2_Node</a>* node = NULL;</div><div class="line">bo_uint index = 0;</div><div class="line">bo_int64 frameID = 9999;</div><div class="line">bo_bool flag = 0;</div><div class="line"></div><div class="line"><a class="code" href="a00029.html#ga6f8f9a70517de7e7e30120260932263d">BGAPI2_Device_GetDataStream</a>(device, 0, &amp;datastream);</div><div class="line"><a class="code" href="a00030.html#ga32a99e1e6d74150462c62e0aed721cf0">BGAPI2_DataStream_Open</a>(datastream);</div><div class="line"></div><div class="line"><span class="keywordflow">for</span> (index = 0; index &lt; 5; index++) {</div><div class="line">    <a class="code" href="a00031.html#ga974a364adb0335d9000e2e3d8dd0c3a6">BGAPI2_CreateBuffer</a>(&amp;buffer[index]);</div><div class="line">    <a class="code" href="a00030.html#ga52ef0114ee88d904a8d030db629da94a">BGAPI2_DataStream_AnnounceBuffer</a>(datastream, buffer[index]);</div><div class="line">    <a class="code" href="a00030.html#ga613165fd182f04c8bb0c7a9f55b908af">BGAPI2_DataStream_QueueBuffer</a>(datastream, buffer[index]);</div><div class="line">}</div><div class="line"></div><div class="line"><a class="code" href="a00030.html#gae746a635a556d8598fc722e6e410dd7b">BGAPI2_DataStream_StartAcquisitionContinuous</a>(datastream);</div><div class="line"><a class="code" href="a00029.html#gafc0bdfc74d18c787b0abec69d20a0485">BGAPI2_Device_GetRemoteNode</a>(device, <span class="stringliteral">&quot;AcquisitionStart&quot;</span>, &amp;node);  <span class="comment">// Get the AcquisitionStart feature</span></div><div class="line"><a class="code" href="a00032.html#ga4a8ff179abaaf701ca6208b85da234d5">BGAPI2_Node_Execute</a>(node);                                       <span class="comment">// Execute the feature</span></div><div class="line"></div><div class="line"><span class="keywordflow">for</span> (index = 0; index &lt; 10; index++) {</div><div class="line">    <span class="comment">// Get the image from the camera into the buffer provided</span></div><div class="line">    <span class="keywordflow">if</span> (<a class="code" href="a00030.html#ga76bcbef15426477683bed38ca84376a6">BGAPI2_DataStream_GetFilledBuffer</a>(datastream, &amp;bufferfilled[index], 1000) == <a class="code" href="a00040.html#gga3b6f47d8814c80ce0c600f366d531ad9aa1261e544f6188516857a20de0c41d0c">BGAPI2_RESULT_SUCCESS</a>) {</div><div class="line">        <a class="code" href="a00031.html#ga865dbb48f31f31933979de72778de607">BGAPI2_Buffer_GetIsIncomplete</a>(bufferfilled[index], &amp;flag);</div><div class="line">        <span class="keywordflow">if</span> (flag)</div><div class="line">            printf(<span class="stringliteral">&quot;Buffer incomplete\n&quot;</span>);</div><div class="line">        <span class="keywordflow">else</span> {</div><div class="line">            bo_uint64 frameID = 9999;                                 <span class="comment">// Set the frame ID to something arbitary</span></div><div class="line">            <a class="code" href="a00031.html#gaa47d9986c6175ddea20f337e4208ca08">BGAPI2_Buffer_GetFrameID</a>(bufferfilled[index], &amp;frameID);  <span class="comment">// Get the frame ID from the image to check if we got an image</span></div><div class="line"></div><div class="line">            printf(<span class="stringliteral">&quot;Buffer with buffer ID %lld received\n&quot;</span>, (<span class="keywordtype">long</span> <span class="keywordtype">long</span>)frameID);</div><div class="line">        }</div><div class="line">    }</div><div class="line">    <span class="keywordflow">else</span></div><div class="line">        printf(<span class="stringliteral">&quot;no buffer received\n&quot;</span>);</div><div class="line">}</div></div><!-- fragment --> <div class="caption">Example: Bad! You must return the buffer to the Baumer GAPI</div> </div></div><!-- PageDoc -->
</div><!-- contents -->
<!-- HTML footer for doxygen 1.8.8-->
<!-- start footer part -->
</div>
</div>
</div>
</div>
</div>
<hr class="footer" /><address class="footer">
    <small>
        Baumer GAPI SDK for C Documentation ver. 2.10.0,
        generated by <a href="http://www.doxygen.org/index.html">
            Doxygen
        </a>
    </small>
</address>
<script type="text/javascript" src="doxy-boot.js"></script>
</body>
</html>
